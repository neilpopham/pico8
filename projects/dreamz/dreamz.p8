pico-8 cartridge // http://www.pico-8.com
version 43
__lua__

-- fog
poke(0x5F34, 0x2)
poke(0x5F34, 0x3)

-- change palette
poke(0x5f2e,1)

pal(15,0)

class=setmetatable(
    {
        new=function(_ENV,tbl)
            return setmetatable(tbl or {},{__index=_ENV})
        end
    },
    {__index=_ENV}
)

entity=class:new({
    -- tile=function(p)
    --     return p\8
    -- end
})

#include functions.lua
#include mapmaker.lua
#include player.lua

mapmaker()

function _update60()
    if btn(0) then p.x-=1 end
    if btn(1) then p.x+=1 end
    if btn(2) then p.y-=1 end
    if btn(3) then p.y+=1 end

    if btnp(4) or btnp(5) then mapmaker() end

    p:update()
end

function _draw()
    cls()
    local cx,cy=p.x,p.y
    camera(cx-56,cy-56)
    map(0,0)

    p:draw()

    camera(0,0)
    circfill(64,64,28,0b0001100100000000.0111111111011111)
    circfill(64,64,32,0b0001100100000000.0101111101011111)
    circfill(64,64,36,0b0001100100000000.0101101001011010)
    circfill(64,64,38,0b0001100100000000.0100101000011010)
    circfill(64,64,40,0b0001100100000000.0000000000000000)
end

__gfx__
00000000ffffffffdddddddd55555555cccccccccccccccc333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
00000000ffffffffdddddddd555555553333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
00000000ffffffffdddddddd555555553333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
00000000ffffffffdddddddd555555553333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
00000000ffffffffdddddddd555555553333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
00000000ffffffffdddddddd555555553333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
00000000ffffffffdddddddd555555553333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
00000000ffffffffdddddddd555555553333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
000000000000000055555555dddddddd3333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
000000000000000055555555dddddddd3333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
000000000000000055555555dddddddd3333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
000000000000000055555555dddddddd3333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
000000000000000055555555dddddddd3333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
000000000000000055555555dddddddd3333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
000000000000000055555555dddddddd3333333333333333333333333333333c3333333333333333c33333333333333300000000000000000000000000000000
000000000000000055555555dddddddd3333333333333333333333333333333cccccccccccccccccc33333333333333300000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
