pico-8 cartridge // http://www.pico-8.com
version 43
__lua__

printh("===================")

-- fog
poke(0x5F34, 0x2)
poke(0x5F34, 0x3)

-- change palette
poke(0x5f2e,1)

pal(15,0)

class=setmetatable(
    {
        new=function(_ENV,tbl)
            return setmetatable(tbl or {},{__index=_ENV})
        end
    },
    {__index=_ENV}
)

entity=class:new({
    -- tile=function(p)
    --     return p\8
    -- end
})

#include functions.lua
#include mapmaker.lua
#include player.lua

mapmaker()

function _update60()
    p:update()
end

function _draw()
    cls()
    local cx,cy=p.x,p.y
    camera(cx-56,cy-56)
    map(0,0)

    p:draw()

    camera(0,0)
    circfill(64,64,28,0b0001100100000000.0111111111011111)
    circfill(64,64,32,0b0001100100000000.0101111101011111)
    circfill(64,64,36,0b0001100100000000.0101101001011010)
    circfill(64,64,38,0b0001100100000000.0100101000011010)
    circfill(64,64,40,0b0001100100000000.0000000000000000)
    print(p.room,0,0,7)
    print(rms[p.room].x,20,0,2)
    print(rms[p.room].y,28,0,2)
end

__gfx__
00000000ffffffffdddddddd55555555cccccccccccccccc33333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
00000000ffffffffdddddddd55555555cccccccccccccccc33333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
00000000ffffffffdddddddd55555555333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
00000000ffffffffdddddddd55555555333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
00000000ffffffffdddddddd55555555333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
00000000ffffffffdddddddd55555555333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
00000000ffffffffdddddddd55555555333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
00000000ffffffffdddddddd55555555333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
000000000000000055555555dddddddd333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
000000000000000055555555dddddddd333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
000000000000000055555555dddddddd333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
000000000000000055555555dddddddd333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
000000000000000055555555dddddddd333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
000000000000000055555555dddddddd333333333333333333333333333333cc3333333333333333cc3333333333333300000000000000000000000000000000
000000000000000055555555dddddddd333333333333333333333333333333cccccccccccccccccccc3333333333333300000000000000000000000000000000
000000000000000055555555dddddddd333333333333333333333333333333cccccccccccccccccccc3333333333333300000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
