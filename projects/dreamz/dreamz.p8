pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
-- recurring dreamz
-- by rocket zombie

printh("===================")

-- fog
poke(0x5F34, 0x2)
poke(0x5F34, 0x3)

-- change palette
-- poke(0x5f2e,1)
-- pal(15,0)

local myrnd=flr(rnd(32000))+1
-- myrnd=20014
srand(myrnd)
printh('myrnd='..myrnd)

class=setmetatable(
    {
        new=function(_ENV,tbl)
            return setmetatable(tbl or {},{__index=_ENV})
        end
    },
    {__index=_ENV}
)

entity=class:new({
    -- tile=function(p)
    --     return p\8
    -- end
})

#include functions.lua
#include mapmaker.lua
#include player.lua

mapmaker()

function _update60()
    p:update()
end

function _draw()
    cls()
    local cx,cy=p.x,p.y
    camera(cx-56,cy-56)
    map(0,0)

    p:draw()

    camera(0,0)

    circfill(64,64,28,0b0001100100000000.0111111111011111)
    circfill(64,64,32,0b0001100100000000.0101111101011111)
    circfill(64,64,36,0b0001100100000000.0101101001011010)
    circfill(64,64,38,0b0001100100000000.0100101000011010)
    circfill(64,64,40,0b0001100100000000.0000000000000000)

    print(p.room,0,0,7)
    -- print(rms[p.room].x,20,0,2)
    -- print(rms[p.room].y,28,0,2)
    print(myrnd,103,0,3)
end

__gfx__
0000000000000000dddddddd55555555cccccccc0000000033333333333333cc0000000000000000cc3333330000000000000000000000000000000000000000
0000000000000000dddddddd55555555cccccccc0000000033333333333333cc0000000000000000cc3333330000000000000000000000000000000000000000
0000000000000000dddddddd55555555333333330000000033333333333333cc0000000000000000cc3333330000000000000000000000000000000000000000
0000000000000000dddddddd55555555333333330000000033333333333333cc0000000000000000cc3333330000000000000000000000000000000000000000
0000000000000000dddddddd55555555333333330000000033333333333333cc0000000000000000cc3333330000000000000000000000000000000000000000
0000000000000000dddddddd55555555333333330000000033333333333333cc0000000000000000cc3333330000000000000000000000000000000000000000
0000000000000000dddddddd55555555333333330000000033333333333333cc0000000000000000cc3333330000000000000000000000000000000000000000
0000000000000000dddddddd55555555333333330000000033333333333333cc0000000000000000cc3333330000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000003333333300000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000cccccccc00000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000cccccccc00000000000000000000000000000000000000000000000000000000
88888888888888889999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000000000999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000000000999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000099999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000099999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000000099999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000000099999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000099999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000099999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000000000999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889990000000000999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
88888888888888889999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
66666666666666ddddddddddddddddddddddddddd666666d554dddddddddddddddddddd666666666666666666666666666666666666666666666666666666666
66666666666666ddddddddddddddddddddddddddd66666665554ddddddddddddddddddd666666666666666666666666666666666666666666666666666666666
66666666666666ddddddddddddddddddddddddddd66666665555ddddddddddddddddddd666666666666666666666666666666666666666666666666666666666
66666666666666ddddddddddddddddddddddddddd6666666d5154dddddddddddddddddd666666666666666666666666666666666666666666666666666666666
6666666666666ddddddddddddddddddddddddddd6666666665155dddddddddddddddddd666666666666666666666666666666666666666666666666666666666
6666666666666dddddddddddddddddddddddddd666666666651154ddddddddddddddddd666666666666666666666666666666666666666666666666666666666
66666666666d6dddddddddddddddddddddddddd6666666666d5155dddddddddddddddddd66666666666666666666666666666666666666666666666666666666
66666666666dddddddddddddddddddddddddd666666666666d51154ddddddddddddddddd66666666666666666666666666666666666666666666666666666666
6666666666ddddddddddddddddddddddddddd666666666666651155ddddddddddddddddd66666666666666666666666666666666666666666666666666666666
66666666666dddddddddddddddddddddddddd6666666666666d51154dddddddddddddddd66666666666666666666666666666666666666666666666666666666
6666666666ddddddddddddddddddddddddddddd66666666666d51155dddddddddddddddd66666666666666666666666666666666666666666666666666666666
666666666dddddddddddddddddddddddddddd66666666666d6651155ddddddddddddddddd6666666666666666666666666666666666666666666666666666666
66666666dddddddddddddddddddddddddddddd6666666666d66d51555ddddddddddddddddd666666666666666666666666666666666666666666666666666666
6666666dddddddddddddddddddddddddddd666dd66666666dd6d51155dddddddddddddddddd66666666666666666666666666666666666666666666666666666
6666666dddddddddddddddddddddddddd666666666666666dd6d551555ddddddddddddddddd66666666666666666666666666666666666666666666666666666
d66ddddddddddddddddddddddddddddd6666666666666666dddd555555dddddddddddddddddd6666666666666666666666666666666666666666666666666666
dddddddddddddddddddddddddddd6ddddd666666666666666d66d555555dddddddddddddddddd666666666666666666666666666666666666666666666666666
dddddddddddddddddddddddddddddddddd666666666666666dd6d5155555dddddddddddddddddd66666666666666666666666666666666666666666666666666
ddddddddddddddddddddddddddddddddddd666666666666666ddd5555555dddddddddddddddddddd666666666666666666666666666666666666666666666666
dddddddddddddddddddddddddddd6dddddddddd66666666666dddd5555555ddddddddddddddddddddddd66666666666666666666666666666666666666666666
dddddddddddddddddddddddddddddddddddddddd66666666666ddd55555555ddddddddddddddddddddddd6666666666666666666666666666666666666ddddd6
ddddddddddddddddddddddddddddddddddddddd6666666666666ddd515dd555ddddddddddddddddddddddddd666666666666666666666666666666ddddddddd6
ddddddddddddddddddddddddddddddddddddddd6666dd666666dd6d55555555ddddddddddddddddddddddddddd66666666666666666666666dddddddddddddd6
ddddddddddddddddddddddddddddddddddddddd666ddddd6666dddd5551555555dddddddddddddddddddddddddd6ddd66666666666dd6dddddddddddddddddd6
dddddddddddddddddddddddddddddddddddddd66666dddddddddddd5555555555dddddddddddddddddddddddddddddddddd6ddddddddddddddddddddddddddd6
ddddddddddddddddddddddddddddddddddddd6666666dddddddddddd55555555555dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6
dddddddddddddddddddddddddddddddddddd66666666dddddddddddd5515555555555dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6
dddddddddddddddddddddddddddddddddddd66666666dddddddd55ddd511115555555dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6
ddddddddddddddddddddddddddddddddddd66666666ddddddddddd5dd5111155555555dddddddddddddddddddddddddddddddddddddddddddddddddddd555556
dddddddddddddddddddddddddddddddddd6666ddd666ddddddddd555d511115555555555ddddddddddddddddddddddddddddddddddddddddddddddd666666666
dddddddddddddddddddddddddd6dddddd6666dd4dddd6ddddd555d55dd511115555555555ddddddddddddddddddddddddddddddddddddddddddd666666666666
dddddddddddddddddddddddddddddddd66666dd4dddddddddddd5555dd511115551155555ddddd5555ddddddddddddddddddddddddddddddd666666666666666
dddddddddddddddddddddddddddddddd6666ddd5dddddddddddddd55dd51111511111555555ddd555555d5ddddddddddddddddddddddddd666666666666dd6d6
dddddddddddddddddddddddddddddddd666ddddddddddd66ddddd5555dd51555511115555555555555555555dddddddddddddddddddd66666dd66d6666666666
dddddddddddddddddddddddddddddddd66ddddddddddddddddddd5555dd555555511155555555555555555555ddddddddddddddddd6666dd6666666666666dd6
ddddddddddddddddddddddddddddddd666ddddddd666dddddd6dd44555d5555555115555555555555555555555dddddddddddddd666dddd66666666666666dd6
ddddddddddddddddddddddddddd666666ddddddd66666666666dd454455455555511555555555555555555555555dddddddddd666666666d666666666666ddd6
ddddddddddddddddddddddddd6666666dddddddd6666666666dddd55555555555511555555555555555555555555555dddd5d66dd666666666666666666dddd6
dddddddddddddddddddddddddd666666dddddddd6666666666dd5455555555d55511555555555555555555555555555555d666dddddd66666666666666ddddd6
dddddddddddddddddddddddddd666666ddd5ddd66666666dddd5555455555dd551115d555dddd55515555555555555555566ddd66666666666666666ddddddd6
dddddddddddddddddddddddddd666666ddd55dd6666ddddd5555555555555ddd55115dd55dddd5555555555555511555d6d66666666666666666666666ddddd6
dddddddddddddddddddddddddd66666ddddd5dddd6dddd555555d555d5555d5555555555ddddd555555555555511115d6ddddd6666666666666666666dddddd6
ddddddddddddddddddddddddd66666dddddddddddddddd55555555d55dd5dd5555555555ddddd555d5555d51551115d6dd4d66666666666666666dddddddd4d6
dd666666ddd666ddddddddd6666666dddddddddddd5555dd5555dd5555d5555555555555dddd555555dd551155115d6555dddd66666666666666666dddddd4d6
d66666666d66666dddddddd666666ddddddddd44dddd555dd55555555dd555dd5555d4555555555155d551555115d6d5dddd6d66666666666666666dddddddd6
d66666666666666ddddddd6666666ddddddddd5555555d55ddddd55dddd55555555dd45d55dd51115555115555556dddd4ddddddd6666666666dddddddddddd6
66666666ccc6666ddddddd6666666ddddddddd55555555ddddd5d6d55dd5dd45555ddd555551555555111555555dd55ddddd6dddddddddddddddddd44ddddd66
66666666cccc6666dddddd6666666ddddddddddd4555555555dd55555ddd445555ddd55d55551155511155554dddd5555dd6444ddddd666dddddd444ddddddd6
d6666666cccc6666dddddd666666dddddddd44dd4555dd5ddd5555dd5ddd44555dd6d55551555d555111554544dddddd5554444ddddddd4444444444ddddd6d6
dd666666cccc666dddddd6666666dddd55444ddddddddddddd55555ddddd45555dd6d4555555555511055d55554555dd5dddddddd44444444444444dddddddd6
dc666666ccccc6ddddddd666666dddd554444ddddddddddd5dd5d6666ddd444dd4d66d5555555d55551545555555455d5dd444555544ddddddd4444ddddd6dd6
dcc6666ccccccddddddd6666666ddd555545ddddddddddddd55dd666dddd4ddd64d6d455555155555155555555554d6dd445dddddd44ddd44444444ddddd6dd6
dcc6666ccccccddddddd666666ddddd555d5dd66dd6dd66ddddd6d666ddd6666e4e6d55115d5555555555555555554ddddd555444ddd55ddd444444dddddddd6
ccc666ccccccddddddd666666dddddd5dddd6666d6dd6666666666666666f666d466d45555515d55555d555555dd4ddd6d555ddddd66d5554444444dddd6ddd6
ccc666ccccccddddddd666666dddd555dddd666666666666666666766666666fe4f6d5555d515551555555555d655dd6ddd6dd5555555554444444444d6dddd6
cc666ccccccdddddddd666666dd555555555d6666d666666666666766666776fe4664515dd5555111555555d5555554d666d5555555555554455544dd66dddd6
cc666cccccdd6666d66666666ddd55111115ddd66666676666666666ff6677ff4e6d4555dd11500155d555d64555555d6666ddd5555d6dd55555544dd666ddd6
cc666cccc6666666666666666dddd5511111555d66666ddddd66666f66f777ffeffd511555515d5555555dd5d555555ddd6666d4555555555555544dd6666666
cc666ccc66666666666666666ddddd5551111115ddd55110005d6666667777fff6655551515ddd55555d7d5d555554dd6dddddddd45555555444444466666666
cc66ccccc6666666666666666ddddd55555111115d5511010000566666677ffff655555555ddd51155555555555d6555546666ddd44455554444444d66666666
cc6ccccc66666666666666666dddddd55555555d6d5155555110156666666ff66f6d55555ddddd501d655555d655555554ddd44d444555554444d45d66666666
cccccccc666666666666666666dddddddd5556666511555d6d5111d66666666666d550555d66dd5101555d6555555544d4dddddddd5555544444dd5d66666666
ccccccccc6666666666666666ddddd6ddd55d666d51555555dd511566666d66ddd55555dd6666dd555dd55555556d5555555dd666d45452222444dd666666666
cccccccccc6666666666666666ddddd66d55d666d155551111151156666dd65d6ddd5d556666dd5555dd5ddd555555555545d666dddd45222224ddd666666666
cccc666cccc66666666dd666666ddd666d55d666d155511111115156666dd6655dddddd666666d566666dd5554455555555ddd666dd42222254dddd666666666
cccc6666cccc666666dddd6666ddd6666d55dd66d15551100011515d6665ddddddddddf666666dd6666d5d55555555555554dddddd42255554ddd66666666666
ccc666666cccd66666ddddd666dddd666dd55d6651155511111551566665555ddd55d5dd6666de666666dd455555555555554ddd4522255544ddd66666666666
ccc666666ccdd66666ddddddddddd6666dd55d66d5155511115551566766dd5d555dddddd666666666666dd455555555555444445555555554dd666666666666
cc6666666ddd666666dddddddddddd666d5455d6d5115555555511d6666dddd5505ddddd6666666666666dddd555555555554455555555554ddd666666666666
cc666666ddd66666666dddddddddddd66d5555d66d511555551111d6676d665555d6d55d6666dd6666666ddd5555555555555444555555554dddd66666666666
cc666666dd66666666dddddddddddddddd5d5ddd66d51011110115676666d555d5dddd6666d45555d66666d66dd5455555555544555555554dddd66666666666
666666dd666666666ddddd566dddddd5ddd55dddd66d511000111d67666dddd55555d6666d51111101566666dddd5555555555545555555554dd666666666666
66666666666666666dddddddd66ddd555dd55ddddd6666666d555d66666dd55555dd66d6d5100000001566666dd5444455555554551155555dd6666666666666
66666666666666666ddddddddddddd555555555dddd666666d5555ddd666d55ddddd666d51015d6d51115d666ddd444555555555555555555dd6666666666666
666666666666666dddddddd55dddd6d55555555dddddd666d55515dd6666d5555ddd66650015555555111566ddddd55544555555555555555d66666666666666
66666666666666dddddddddd555dddd6d5555555d5dddd66dd5115d6666dd5d66d6666511115511155511156ddddddd444555555555555555d66666666666666
dd66666666666ddddddddddd5555ddddddd4d5555555dddddd515dd6666dddddddd66d51015511001155115ddd4dddd44455445555555555dd66666666666666
cdd666666666ddddddddddd555555dddddfddd4555dddddd555156666666dddd6dd6651111551010115511555444ddd44444555555555555dd66666666666666
c766666666ddd66776dddd5555555dddddddddddd6666dddd55ddd6666666ddddddd511111551111155511551155544444445555555555555d66666666666666
cd6666666666ddddddddd5d7d55555ddddd45666666666ddd5d5ddd666666dddd455111111555111155511551111555444455555555555555dd6666666666666
c666666666666ddddddddd55555566dddddddddd666666dddd55dd666666666dd511551111155515555515dd5111111555555555555555555dd6666666666666
c666666666666ddddddddddddddd55566dddd66666d666666dd4ddddd66ddd5dd5111155101155555510156dd51001115555555555555555ddd6666666666666
d666766666666dddddddddddd555555dddd66666665ddd6666d5dddddddddd454511155dd511115510115d6ddd5110111555555555555555dd66666666666666
6667776666666ddddd676666666776d5ddddd66676655d6f6d555dddddddd6d44511554d66d110000155d666d45510011555511555555555dd66666666666666
66677666666666dddddddddd5ddddddddddd67766666d5d66d555ddddddd454555115546666d511155d666ddd4555551115555555555555ddd66666666666666
66777666666ddddddd5d666666dddddd666667776d6666666d511555dddd55555551544d66666ddddd6ddd4445555511111155555555555dd666666666666666
6777666666ddddd6dddddddddddd666666ddd66666d5d6666d555155dd5555555555544dddd66ddddddd555555555551111111555555555dd666666666666666
6776666666666dddddddddd66666676666666d6666ddd6666d51125111155555445555dd45dddddd4dd555544455555111111115555555ddd666666666666666
6776666666666ddddddd66676666dddddd666766d6666666665112222511155444444445555dd444455555555444455551155555555555ddd666666666666666
6766676666dddd555d576666666666dd66666676dd6666666d51122222211154dd444554d4555555555555555554445555555555555555dd6666666666666666
667777666dddd5dd755dd66666667667d55d666666dd6666665552221011055ddddd444dd5544555555555444444544555555555555555dd6666666666666666
6667776ddddd565dd55dd66666667666667d5d666d666ddd66d51121101156666ddddd4d6d44555555555444d44444455555555555555dd66666666666666666
66677776dd56d555dd55dd666666667676d566ddd6666ddd44d51111115dd666d5dd544dd44555555555554ddd444455555555555555ddd66666666666666666
777777766ddddd5555556dd666666666666d555ddd66ddd44445111555d666666d555554ddd445555555555555445555555555555555ddd66666666666666666
7777777666d5dd555575555dd6666dd6666dd55ddddddddd45551154ddd6d55d66666dd444dd67777651555551111115555555555555dd666666666666666666
7777777766d555d56511d55d6d6dddd66666d5555ddd6dd4444225554dd6ddd55ddd66666d44444455511d666501155555555555555ddd666666666666666666
777777766dd55551551155d5dddd556ddddddd5555dddddd4444424444ddd66ddd55d66d66f65555555511111565d51555555555555dd6666666666666666666
777666666d5557555751565555555555ddddddd555dddddddd44444444444dd66dd66666d66d55567d55555551111565d555555555ddd6666666666666666666
777646666d5555555555d5d55551555555d5ddddd55dddddddd4444444dddd444ddd666666444665555465555511115556d555555ddd66666666666666666666
7676dd666d655555555116511511555555555555555ddddddddddd44444ddddddd666666d5dd5555d6555555d51111115555d555ddd666666666666666666666
7766666666555555551165511515555555555555555dd5dd6dddddd4444dddddddd66dddd6d555555515d511115d1111155555d5dd6666666666666666666666
666666666dd555555515555165155555555555555555555ddddddddddd4dddddddddd555555515555111115d111115611155555ddd6666666666666666666666
6766666666d56555d565551011555551151111555555555ddddddddddd444444444455d115dd6511111111115d111115d11555ddd66666666666666666666666
666666666ddd555516115511115555111111111555555555554ddd44444445555555dddd115d056111111111115d0111115ddddd666666666666666666666666
66666f6666d5555510111511155551111111115515551555555555555455555515511dd5d111115d1111111111115d111555d666666666666666666666666666
666666666dd5555511111d11155511111111155111111151155555155551111111111155551115d0151110011111015d155ddd66666666666666666666666666
66666d66dd55555d11111111111111111111111111111111111111111111111111111115d500115d05d10000000001115dddddd6666666666666666666666666
66d6d66d4d555151111175111111111111111100011111111111111111111111011100001dd10001115d00000000011155dddddd666666666666666666666666
6dd6dddd5551111111111111111101110011000010011111111111111111111111110000005d00000115d10000001111555ddddd666666666666666666666666
4dddd455551116511110000000110000011000111111111111111111111111111111111105dd111110155d51111111115555d6ddd66666666666666666666666
445555511510111111151111555555555555555555555555511111111111111111111111111dd111111555d51111115555555ddddd6666666666666666666666
255151115555555555ddddddddddddd55555555555555555555511111111111111111111111551111115555d55555555555dddd6666666666666666666666666
dd6d66dddddd66ddddddddd6f6ddddddddddddddddd44555555555555555555555555555555d6d5555555ddddddddddddddddddd666666666666666666666666
666666666ddddddddddddddddddddddddddddddddddd6dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666
666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddd666d6dd6dd6666666666666666666666666666666
66666666666666666dd6dddddddd6d6ddd6666666666666666666d66666666666666666666666666666666666666dd6666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666d66666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
66766666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
77766666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
77766666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
77776666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
77776666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
77777666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
77777766666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666

__gff__
0000000001000101000001000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
