pico-8 cartridge // http://www.pico-8.com
version 42
__lua__

-- ⬅️➡️⬆️⬇️🅾️❎

function mrnd(x,f)
    if f==nil then f=true end
    local r=x[1]+rnd((f and 1 or 0)+x[2]-x[1])
    return f and flr(r) or r
end

function range(n,m)
    return mrnd({n,m})
end

-- https://nerdyteachers.com/PICO-8/Palette/?c=WzAsMTYsMTcsMSwyOCwxMiwxOCw4LDExLDI2LDI1LDksMTAsMjMsNiw3XQ==
poke(0x5f2e,1)
pal({[0]=0,-16,-15,1,-4,12,-13,11,-6,-14,8,-7,9,10,6,7},1)

function _init()
    x,y=0,120
    bits={}
end 

function _update60()
    if (btn(➡️)) x+=1
    if (btn(⬅️)) x-=1

    if btnp(🅾️) then
        d=1
        for by=0,7 do 
            for bx=0,7 do 
                -- add(bits,{x+bx,y+by,mrnd({5,50}),mrnd({30,90}), 7})
                -- saves 2 tokens in total using properties (b.x vs b[1])
                add(bits,{x=x+bx,y=y+by,dy=range(5,50),l=range(30,90),c=8})
            end
        end
    end

    if (btnp(❎)) d=nil
end 

function _draw()
    cls()
    if not d then 
        spr(1,x,y)
    end
    for i,b in pairs(bits) do
        pset(b.x,b.y,b.c)
        b.y-=b.dy
        if (b.y<0) deli(bits,i) 
        b.l-=1
        if (b.l==0) deli(bits,i)
        b.dy*=0.97

        -- pset(b[1], b[2], b[5])
        -- b[2]-=b[3]
        -- if (b[2]<0) deli(bits, i) 
        -- b[4]-=1
        -- if (b[4]==0) deli(bits, i)
        -- b[3]*=0.97
    end  
    print(#bits,0,0,8)

    -- test range() function
    -- for i=0,127 do 
    --     py=range(0,64)
    --     pset(i,py,3)
    -- end
end 

__gfx__
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100030005003050020500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
