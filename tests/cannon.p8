pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--
-- by Neil Popham

function _init()
 poke(0x5f2d, 1)
 px,py=64,64
 nx,ny=px,py
end

function _update60()
 b,x,y=stat(34),stat(32)-1,stat(33)-1
 dx=x-px
 dy=y-py
 a=atan2(dx,-dy)
 s=flr(a/0.125)+2

 if b==1 then
  nx=x-3
  ny=y-5
 end

 if nx~=px or ny~=py then

  na=atan2(nx-px,py-ny)

  dx=cos(na)
  dy=-sin(na)

  px+=cos(na)
  py-=sin(na)

  local cdx=abs(px-nx)
  if cdx<.5 then px=nx end
  local cdy=abs(py-ny)
  if cdy<.5 then py=ny end
 end

 --[[
 if nx<px then px-=1 end
 if nx>px then px+=1 end
 if ny<py then py-=1 end
 if ny>py then py+=1 end
 ]]
end

function _draw()
 cls(11)



 spr(s,px,py)
 spr(1,x,y)

 print(stat(34),0,0,1)
 print(x,20,0,1)
 print(y,40,0,1)
 print(s,60,0,1)
 print(a,90,0,1)

 print(na,0,10,3)
 print(nx,40,10,3)
 print(ny,60,10,3)

end
__gfx__
00000000333000000003300000033000000330000003300000033000000330000003300000033000000000000000000000000000000000000000000000000000
0000000037d330000033330000333300003333000033330000333300003333000033330000333300000000000000000000000000000000000000000000000000
000000003d76d3300033ff000033ff00003ff30000ff330000ff330000f333000033330000333f00000000000000000000000000000000000000000000000000
00000000036776d3003fff00003fff0000ffff0000fff30000fff30000ff3300003333000033ff00000000000000000000000000000000000000000000000000
0000000003d77763003333000033f300003ff300003f330000333300003333000033330000333300000000000000000000000000000000000000000000000000
00000000003676330033330000333300003333000033330000333300003333000033330000333300000000000000000000000000000000000000000000000000
00000000003d63630033330000333300003333000033330000333300003333000033330000333300000000000000000000000000000000000000000000000000
00000000000333330001100000011000000110000001100000011000000110000001100000011000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000003300000033000000330000003300000033000000330000003300000033000000000000000000000000000000000000000000000000000
00000000000000000033330000333300003333000033330000333300003333000033330000333300000000000000000000000000000000000000000000000000
0000000000000000003333000033ff000033ff0000333f000033330000f3330000ff330000ff3300000000000000000000000000000000000000000000000000
000000000000000000ffff0000ffff00003fff000033ff000033330000ff330000fff30000ffff00000000000000000000000000000000000000000000000000
0000000000000000003ff300003ff3000033ff0000333300003333000033330000ff3300003ff300000000000000000000000000000000000000000000000000
00000000000000000033330000333300003333000033330000333300003333000033330000333300000000000000000000000000000000000000000000000000
00000000000000000033330000333300003333000033330000333300003333000033330000333300000000000000000000000000000000000000000000000000
00000000000000000001100000011000000110000001100000011000000110000001100000011000000000000000000000000000000000000000000000000000
